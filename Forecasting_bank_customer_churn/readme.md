# Прогнозирование оттока клиента Банка

### Задача
На основе данных из банка определить клиента, который может уйти.
   
## Этапы исследования
1. Подготовка данных.

2. Исследование задачи.

3. Борьба с дисбалансом.

4. Тестирование модели.

5. Выводы.

## Выводы
В ходе построения модели предсказания ухода клиентов из банка, была проделана следующая работа:
1. Проведена предобработка данных:
    - Мы устранили пропуски в столбце Tenure - на них приходилось всего 9% данных, поправили названия столбцов. Дубликаты в данных не обнаружены.
2. Провели исследование задачи:
    - Выяснили, что данные не сбалансированны: на класс "0" приходится 80% данных, а на класс "1" - 20%.
    - Исключили столбцы RowNumber, CustomerId, Surname т.к. для обучения модели они не помогут.
    - Провели масштабирование данных.
    - Обучили модель без учета дисбаланса, с использование дамми-ловушки.
    - Рассмотрели 2 модели: случайный лес и логическую регрессию, проверили для каждой модели f1-меру. Лучший результат показала модель случайного леса  с глубиной 26 и количеством деревьев 41 - 0.61, ее мы и ииспользовали в дальнейшем.
3. Проверили разные методы для борьбы с дисбалансом:
    - С использованием метода балансировки весов классов мы получили значение f1-меры равное 0.57.
    - Увеличив выборку с классом "1" в 4 раза мы получили значение f1-меры равное 0.62.
    - Уменьшив выборку с классом "0" в 0.25 раз мы получили значение f1-меры равное 0,61.
    - Увеличив выборку с классом "1" в 2 раза и уменьшив выборку с классом "0" в 2 раза мы получили значение f1-меры равное 0,63.
    - Изменив порог классификации на 0.37 мы получили значение f1-меры равное 0.66. Значение AUC-ROC составило 0.78.
4. Протестировали модель:
    - Результаты предсказаний на тестовой выборке показали значение f1-меры равное 0.61. Также мы получили значение AUC-ROC - 0.71.
В итоге нам удалось достичь значения f1-меры большее 0.59.
